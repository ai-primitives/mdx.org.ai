name: CI\n\non:\n  push:\n    branches: [ main ]\n    paths:\n      - "packages/mdxld/**"\n  pull_request:\n    branches: [ main ]\n    paths:\n      - "packages/mdxld/**"\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    defaults:\n      run:\n        working-directory: packages/mdxld\n\n    strategy:\n      matrix:\n        node-version: [18.x, 20.x]\n\n    steps:\n      - uses: actions/checkout@v4\n      - uses: pnpm/action-setup@v2\n        with:\n          version: 8\n      - name: Use Node.js ${{ matrix.node-version }}\n        uses: actions/setup-node@v4\n        with:\n          node-version: ${{ matrix.node-version }}\n          cache: "pnpm"\n          cache-dependency-path: "packages/mdxld/pnpm-lock.yaml"\n      - run: pnpm install\n      - run: pnpm run build\n      - run: pnpm run test\n      - run: pnpm run docs\n\n  publish:\n    needs: build\n    runs-on: ubuntu-latest\n    if: github.event_name == "push" && github.ref == "refs/heads/main"\n    defaults:\n      run:\n        working-directory: packages/mdxld\n\n    steps:\n      - uses: actions/checkout@v4\n      - uses: pnpm/action-setup@v2\n        with:\n          version: 8\n      - uses: actions/setup-node@v4\n        with:\n          node-version: 20\n          registry-url: https://registry.npmjs.org/\n      - run: pnpm install\n      - run: pnpm run build\n      - run: pnpm publish\n        env:\n          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
